# Запуск приложения в Docker
- Для каждого микросервиса (`auth`, `content`)
в одноименном каталоге создать файл `.env` на основе `.env.example`
- Выполнить команду:
```
docker compose up --build -d
```
- Документация Auth API доступна по адресу: http://localhost:8000/api/openapi/
- Документация Content Mock API доступна по адресу: http://localhost:8001/api/openapi/
- Тестовые пользователи в Auth сервисе:
```
login1 / password1 (role1)
login2 / password2 (role2)
```
- Тестовые эндпоинты в контент сервисе:
```
/content_1 - доступен для role1
/content_2 - доступен для role1 и role2
```

# Используемые технологии
- FastAPI
- Redis
- Docker

# Документация
Схемы работы Auth сервиса с JWT токенами приведены в `docs`

# Описание
- Auth сервис работает с хранилищами пользователей и токенов через интерфейсы абстрактных классов
- Реализация хранилища пользователей (для тестового задания) - словарь в памяти
- Кэш для токенов - Redis
- Auth сервис поддерживает множественные логины
- Время жизни токенов можно настраивать через `.env`
- Refresh токен является одноразовым (white list)
- Logout производит отзыв access (black list) и refresh токенов
- Реализован механизм logout_others - отзыв всех ранее выданных access и refresh
токенов с генерацией новой пары токенов для текущего сеанса
- Для контроля утечек токенов можно реализовать контроль "цифровых отпечатков" клиентов
плюс анализ активных сеансов по количеству выданных токенов
- Content сервис валидирует access токены локально и проверяет их отозванность в Auth сервисе
- Реализована "изящная деградация" в случае отказа или недоступности Auth сервиса

# Развитие
- Реализация хранилища пользователей c помощью SQLAlchemy
- Nginx прокси для высоких нагрузок: С10k и горизонтальное масштабирование
- Регистрация пользователей, смена и восстановление пароля
- История событий входа
- CRUD для ролей, назначение и отзыв роли для пользователей
- Логин через OAuth провайдеров (yandex, vk, etc)
- Мониторинг и алертинг
